{% extends 'package/base_form_page.html' %}

{% set pkg = c.pkg_dict %}

{% block breadcrumb_content_selected %}{% endblock %}

{% block breadcrumb_content %}
  {% set organization = pkg.organization.title or pkg.organization.name %}
  <li>{% link_for _('Organizations'), controller='organization', action='index' %}</li>
  <li>{% link_for organization|truncate(30), controller='organization', action='read', id=pkg.organization.name %}
  <li class="active">{% link_for _('Update') ~ ' ' ~ _(pkg.title), controller='package', action='edit', id=pkg.name %}</li>
{% endblock %}

{% block primary_content %}
  <ul class="col-md-9">
    {% for r in h.recombinant_show_package(pkg).resources %}
      <li class="form-control form-group">{% link_for _(r.description),
        controller='ckanext.recombinant.controller:PreviewController',
        action='preview_table', id=pkg.id, resource_id=r.id %}:
        {{ ngettext("%(num)d row", "%(num)d rows", r.datastore_rows)
          |format(num=r.datastore_rows) }}</li>
    {% endfor %}
  </ul>

  {% if h.check_access('package_update', {'id': pkg.id }) %}
    {% snippet "recombinant/snippets/xls_upload.html",
      pkg=pkg, errors=errors %}
  {% else %}
    {% snippet "recombinant/snippets/xls_download.html",
      pkg=pkg, errors=errors %}
  {% endif %}
{% endblock %}
