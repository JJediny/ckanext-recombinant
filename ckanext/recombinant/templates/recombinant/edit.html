{% extends 'package/base_form_page.html' %}

{% set pkg = c.pkg_dict %}

{% block breadcrumb_content_selected %}{% endblock %}

{% block breadcrumb_content %}
  {{ super() }}
  <li class="active">{% link_for _('Edit'), controller='package', action='edit', id=pkg.name %}</li>
{% endblock %}

{% block primary_content %}
  <header class="module-content page-header"></header>
  <section class="module-poster">
    <div class="module-content">
      {% if h.check_access('package_update', {'id': pkg.id }) %}
        {% snippet "recombinant/snippets/xls_upload.html",
          pkg=pkg, errors=errors %}
      {% else %}
        {% snippet "recombinant/snippets/xls_download.html",
          pkg=pkg, errors=errors %}
      {% endif %}
    </div>
  </section>
  {% if pkg.resources %}
    {% set resource_id = pkg.resources[0].id %}
    <details>
      <summary>{{ _("API Access") }}</summary>
      <p>{% trans %}Access this data through the
        <a href="http://docs.ckan.org/en/latest/maintaining/datastore.html#the-datastore-api">datastore API</a>
        with <code>resource_id="{{ resource_id }}"</code>{% endtrans %}
      </p>
      <p>
        <h4>{{ _("Example:") }}</h4>
        <code>
          curl {{ g.site_url }}/api/action/datastore_search -d '{"resource_id":"{{ resource_id }}"}'
        </code>
      </p>
    </details>
  {% endif %}
{% endblock %}
